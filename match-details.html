<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Select Seats - IPL 2025</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Roboto', sans-serif;
    background: #f4f7fa;
    margin: 0;
    padding: 20px;
    color: #333;
  }
  .container {
    max-width: 600px;
    margin: 0 auto;
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  h2 { text-align: center; color: #222; margin-top: 0; }
  
  /* Match Header */
  .match-header {
    text-align: center;
    border-bottom: 1px dashed #ddd;
    padding-bottom: 15px;
    margin-bottom: 20px;
  }
  .teams { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 15px 0; }
  .teams img { width: 70px; height: 70px; object-fit: contain; }
  .vs { font-weight: 900; color: #f84464; font-size: 20px; }
  
  /* Seat Map */
  .seat-map {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    margin-bottom: 20px;
  }
  .seat-option {
    flex: 1 1 45%;
    background: #e0e0e0;
    padding: 15px;
    text-align: center;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.3s;
    border: 2px solid transparent;
  }
  .seat-option:hover { background: #d0d0d0; }
  .seat-option.active {
    background: #fff;
    border-color: #f84464;
    color: #f84464;
    font-weight: bold;
    box-shadow: 0 4px 10px rgba(248, 68, 100, 0.2);
  }
  .seat-price { display: block; font-size: 14px; margin-top: 5px; color: #555; }

  /* Summary Box */
  .summary-box {
    background: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
    margin-top: 20px;
  }
  .row { display: flex; justify-content: space-between; margin-bottom: 10px; }
  .total-row { font-size: 18px; font-weight: bold; border-top: 1px solid #ddd; padding-top: 10px; margin-top: 10px; color: #f84464; }

  /* Controls */
  .qty-control {
    display: flex;
    align-items: center;
    gap: 10px;
    justify-content: flex-end;
  }
  .qty-btn {
    width: 30px; height: 30px;
    background: #ddd; border: none; border-radius: 50%;
    font-size: 18px; cursor: pointer;
  }
  .qty-val { font-weight: bold; font-size: 16px; width: 20px; text-align: center; }

  /* Pay Button */
  .pay-btn {
    width: 100%;
    background: linear-gradient(90deg, #f84464, #c4242b);
    color: white;
    border: none;
    padding: 15px;
    font-size: 18px;
    font-weight: bold;
    border-radius: 8px;
    margin-top: 20px;
    cursor: pointer;
    transition: transform 0.2s;
  }
  .pay-btn:active { transform: scale(0.98); }
  .pay-btn:disabled { background: #ccc; cursor: not-allowed; }

  .back-link {
    display: block;
    margin-bottom: 15px;
    color: #666;
    text-decoration: none;
    font-size: 14px;
  }
</style>
</head>
<body>

<div class="container">
  <a href="index.html" class="back-link">‚Üê Back to Matches</a>
  
  <div class="match-header" id="header">
    <h2>Loading...</h2>
  </div>

  <h3>Select Seat Type</h3>
  <div class="seat-map" id="seatMap">
    </div>

  <div class="summary-box">
    <div class="row">
      <span>Seat Type:</span>
      <span id="selectedType">None</span>
    </div>
    <div class="row">
      <span>Price per Ticket:</span>
      <span id="priceDisplay">‚Çπ0</span>
    </div>
    <div class="row" style="align-items:center;">
      <span>Quantity:</span>
      <div class="qty-control">
        <button class="qty-btn" onclick="updateQty(-1)">-</button>
        <span class="qty-val" id="qtyDisplay">1</span>
        <button class="qty-btn" onclick="updateQty(1)">+</button>
      </div>
    </div>
    <div class="row total-row">
      <span>Total Payable:</span>
      <span id="totalDisplay">‚Çπ0</span>
    </div>
  </div>

  <button class="pay-btn" id="payBtn" onclick="proceedToPay()" disabled>Select a Seat to Continue</button>
</div>

<script>
  // 1. Load Data from Home Page (stored in localStorage)
  const match = JSON.parse(localStorage.getItem('selectedMatch'));
  const defaultImg = "https://iili.io/K8L5Ots.jpg";

  // Safety check: if no match found, go back
  if(!match) {
    alert("No match selected. Redirecting...");
    window.location.href = "index.html";
  }

  // 2. Render Header
  document.getElementById('header').innerHTML = `
    <h2>${match.teams}</h2>
    <div class="teams">
      <img src="${match.img1 || defaultImg}">
      <div class="vs">VS</div>
      <img src="${match.img2 || defaultImg}">
    </div>
    <div style="font-size:14px; color:#555;">
      üìÖ ${match.date} | ‚è∞ ${match.time || 'TBA'}<br>
      üèü ${match.stadium}
    </div>
  `;

  // 3. Seat Configuration
  const seats = [
    { name: "General Stand", price: 800 },
    { name: "Upper Tier", price: 1200 },
    { name: "Premium Stand", price: 2500 },
    { name: "VIP Box", price: 5000 },
    { name: "Club Lounge", price: 8000 }
  ];

  // 4. Render Seats Dynamically
  const seatMap = document.getElementById('seatMap');
  let currentSelection = null;
  let qty = 1;

  seats.forEach(seat => {
    const el = document.createElement('div');
    el.className = 'seat-option';
    el.innerHTML = `<div>${seat.name}</div><span class="seat-price">‚Çπ${seat.price}</span>`;
    
    el.onclick = () => selectSeat(seat, el);
    seatMap.appendChild(el);
  });

  function selectSeat(seat, el) {
    // UI Update (Visual selection)
    document.querySelectorAll('.seat-option').forEach(d => d.classList.remove('active'));
    el.classList.add('active');
    
    // Logic Update
    currentSelection = seat;
    document.getElementById('payBtn').disabled = false;
    document.getElementById('payBtn').innerText = "Proceed to Pay";
    updateSummary();
  }

  function updateQty(change) {
    if(qty + change >= 1 && qty + change <= 10) {
      qty += change;
      document.getElementById('qtyDisplay').innerText = qty;
      updateSummary();
    }
  }

  function updateSummary() {
    if(!currentSelection) return;
    document.getElementById('selectedType').innerText = currentSelection.name;
    document.getElementById('priceDisplay').innerText = "‚Çπ" + currentSelection.price;
    document.getElementById('totalDisplay').innerText = "‚Çπ" + (currentSelection.price * qty);
  }

  // 5. Proceed to Payment Page
  function proceedToPay() {
    if(!currentSelection) return;

    const paymentData = {
      matchDetails: match,
      seatType: currentSelection.name,
      price: currentSelection.price,
      qty: qty,
      total: currentSelection.price * qty
    };

    // Save to LocalStorage for Payment Page to read
    localStorage.setItem('paymentInfo', JSON.stringify(paymentData));
    
    // Redirect
    window.location.href = "payment.html";
  }
</script>

</body>
</html>
